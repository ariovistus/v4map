<!DOCTYPE html>
<html>
	<head>
        <style>
            .coord-display {
                position: fixed; 
                width: 90px; 
                height: 25px; 
                background-color: blue; 
                color: white;
            }

            body {
                background-color: #9db9f9;
            }
        </style>

        <script src='./svg.js' type='text/javascript'></script>
        <script src='./canyonlands.js' type='text/javascript'></script>
        <script src='./coastline.js' type='text/javascript'></script>
        <script type='text/javascript'>
            //// data!

            var crater = {
                title: "Volcanic Crater",
                world_coords: [
                    [-24, -70],
                    [-49, -45],
                    [-20, 0], // fake!!!
                    [0, 50], // fake!!!
                    [150, 0], // fake!!!
                    [131, -75],
                    [58, -54],
                    [45, -56],
                    [-24, -70]
                ],
                fill: "gray",
                stroke: {color: 'brown', width: '1px'}
            };
            //674 51 // stone overhang thing

            var blue_plants = [
                [-51, -516],
                [680, 90],
                [164, 582],
                [-557, 152],
                [-360, 120],
                [604, -511],
                [653, 462],
                [-422, 67],
                [226, 593],
                    [732, -200],
            ];

            var forage_plants = [
                [-346, -206],
                [-442, -401],
            ];

            var redwood_lake = {
                title: "Redwood Lake",
                world_coords: [
                    [-324, 264],
                    [-317, 265],
                    [-314, 272],
                    [-315, 274],
                    [-320, 273],
                    [-324, 268],
                    [-324, 264],
                ],
                fill: "skyblue",
                stroke: {color: 'darkblue', width: '1px'}
            };

            var rocky_lake = {
                title: "Rocky Lake",
                world_coords: [
                    [676, 77],
                    [677, 83],
                    [679, 87],
                    [677, 90],
                    [672, 91],
                    [667, 92],
                    [665, 90],
                    [666, 87],
                    [670, 82],
                    [673, 79],
                    [676, 77],
                ],
                fill: "skyblue",
                stroke: {color: 'darkblue', width: '1px'}
            };


            var redwood_cliff3 = {
                world_coords: [
                    [-297, -10],
                    [-289, 22],
                    [-293, 82],
                    [-297, 103],
                    [-316, 121],
                    [-319, 117],
                ],
                fill: "none",
                stroke: {color: 'gray', width: '1px'}
            };

            var swamp_lake2 = {
                title: "Pothole Lake",
                world_coords: [
                    [-445, -39],
                    [-450, -39],
                    [-451, -41],
                    [-451, -44],
                    [-446, -46],
                    [-451, -49],
                    [-445, -62],
                    [-441, -46],
                    [-445, -39],
                    [-450, -39],
                ],
                fill: "skyblue",
                stroke: {color: 'darkblue', width: '1px'}
            };

            var big_lake = {
                title: "Big Lake",
                world_coords: [
                    [-574, 129],
                    [-575, 132],
                    [-569, 143],
                    [-574, 147],
                    [-577, 153],
                    [-582, 155],
                    [-585, 154],
                    [-590, 151],
                    [-593, 148],
                    [-595, 144],
                    [-595, 141],
                    [-591, 136],
                    [-586, 133],
                    [-582, 141],
                    [-578, 130],
                ],
                fill: "skyblue",
                stroke: {color: 'darkblue', width: '1px'}
            };

            var scrubby_lake = {
                title: "some scrubby lake",
                world_coords: [
                    [547, 650],
                    [546, 652],
                    [545, 651],
                    [544, 650],
                    [544, 648],
                    [545, 647],
                    [547, 649],
                    [547, 650],
                ],
                fill: "skyblue",
                stroke: {color: 'darkblue', width: '1px'}

            };
            var scrubby_lake2 = {
                title: "another scrubby lake",
                world_coords: [
                    [556, 660],
                    [554, 661],
                    [552, 659],
                    [552, 657],
                    [555, 657],
                    [558, 659],
                    [558, 660],
                    [556, 660],
                ],
                fill: "skyblue",
                stroke: {color: 'darkblue', width: '1px'}

            };

            var pit_lake = {
                title: "Box Lake",
                world_coords: [
                    [651, 480],
                    [658, 474],
                    [656, 465],
                    [652, 461],
                    [645, 461],
                    [639, 471],
                    [641, 479],
                    [651, 480],
                ],
                fill: "skyblue",
                stroke: {color: 'darkblue', width: '1px'}

            };



            var oakwoods_outline = {
                world_coords: [
                    [-403, -83], 
                    [-424, -110], 
                    [-453, -146],
                    [-477, -176],
                    [-469, -181],
                    [-479, -190],
                    [-508, -185],
                    [-545, -199],
                    [-588, -201],
                    [-604, -187],
                    [-594, -185],
                    [-575, -140],
                    [-551, -115],
                    [-512, -106],
                    [-499, -127],
                ],
                fill: "none",
                stroke: {color: 'darkgreen', width: '1px'}
            };

            var boiling_lake_outline = {
                title: "Boiling Lake",
                world_coords: [
                    [160, 554],
                    [168, 562],
                    [168, 565],
                    [165, 575],
                    [159, 584],
                    [154, 584],
                    [154, 577],
                    [159, 573],
                    [157, 568],
                    [156, 563],
                    [160, 554],
                ],
                fill: "skyblue",
                stroke: {color: 'darkblue', width: '1px'}
            };

            var cypress_outline = {
                title: "Cypress Swamp",
                world_coords: [
                    [-15, 417],
                    [-32, 466],
                    [-63, 474],
                    [-97, 478],
                    [-126, 477],
                    [-196, 478],
                    [-218, 452],
                    [-214, 444],
                    [-203, 440],
                    [-209, 437],
                    [-213, 419],
                    [-210, 408],
                    [-221, 401],
                    [-200, 389],
                    [-195, 375],
                    [-193, 359],
                    [-206, 329],
                    [-185, 327],
                    [-177, 333],
                    [-172, 327],
                    [-154, 334],
                    [-140, 335],
                    [-135, 343],
                    [-127, 346],
                    [-119, 341],
                    [-79, 347],
                    [-58, 350],
                    [-31, 367],
                    [-17, 386],
                    [-15, 417],
                ],
                fill: "#eef9d9",
                stroke: {color: 'darkgreen', width: '1px'}
            };

            var another_cliff = {
                world_coords: [
                    [-649, 189],
                    [-655, 188],
                    [-679, 236],
                    [-686, 244],
                    [-687, 247],
                    [-694, 259],
                    [-695, 269],
                    [-698, 277],
                    [-693, 298],
                    [-685, 316],
                    [-687, 334],
                    [-670, 364],
                    [-663, 367],
                    [-658, 388],
                    [-651, 394],
                    [-654, 403],
                    [-669, 417],
                    [-672, 432],
                ],
                fill: "none",
                stroke: {color: 'gray', width: '1px'}
            };

            var cypress_lake = {
                title: "Swamp Lake",
                world_coords: [
                    [-68, 440],
                    [-80, 443],
                    [-77, 430],
                    [-86, 429],
                    [-96, 423],
                    [-101, 422],
                    [-103, 418],
                    [-103, 411],
                    [-116, 402],
                    [-121, 395],
                    [-118, 387],
                    [-119, 380],
                    [-128, 364],
                    [-128, 360],
                    [-139, 353],
                    [-144, 349],
                    [-149, 350],
                    [-152, 358],
                    [-141, 363],
                    [-129, 378],
                    [-128, 400],
                    [-131, 408],
                    [-120, 410],
                    [-110, 416],
                    [-106, 428],
                    [-102, 431],
                    [-95, 431],
                    [-68, 440],
                ],
                fill: "skyblue",
                stroke: {color: 'darkblue', width: '1px'}
            };

            var some_other_lake = {
                title: "Taco Lake",
                world_coords: [
                    [717, -651],
                    [714, -647],
                    [717, -645],
                    [717, -643],
                    [721, -641],
                    [721, -639],
                    [718, -637],
                    [722, -636],
                    [723, -632],
                    [721, -630],
                    [719, -631],
                    [717, -628],
                    [716, -628],
                    [713, -631],
                    [711, -639],
                    [712, -642],
                    [709, -645],
                    [707, -647],
                    [707, -650],
                    [711, -652],
                    [715, -653],
                    [717, -651],
                ],
                fill: "skyblue",
                stroke: {color: 'darkblue', width: '1px'}
            };

            var some_swampy = {
                world_coords: [
                    [-16, 418],
                    [-19, 409],
                    [-23, 407],
                    [-25, 405],
                    [-27, 409],
                    [-25, 414],
                    [-21, 417],
                    [-24, 420],
                    [-25, 416],
                    [-27, 418],
                    [-31, 418],
                    [-34, 415],
                ],
                fill: "none",
                stroke: {color: 'darkblue', width: '1px'}
            };

            var canyon_entrance1_route = {
                waypoints: [
                    [-589, -132],
                    [-627, -136],
                ],
                route: [
                    [-589, -132],
                    [-605, -122],
                    [-627, -136],
                    [-638, -124],
                    [-648, -122],

                ],
                waypointRadius: 5,
                waypointFill: "yellow",
                waypointStroke: {color: 'red', width: '1px'},
                routeStroke: {color: 'red', width: '1px', 'dasharray': '5,10'},
            };
            var canyon_entrance1_route2 = {
                waypoints: [
                ],
                route: [
                    [-627, -136],
                    [-630, -145],
                    [-645, -143],
                    [-674, -154],
                ],
                waypointRadius: 10,
                waypointFill: "yellow",
                waypointStroke: {color: 'red', width: '1px'},
                routeStroke: {color: 'red', width: '1px', 'dasharray': '5,10'},
            };

            var a_route = {
                waypoints: [
                    [529, -210],
                    [677, -85],
                ],
                route: [
                    [529, -210],
                    [546, -182],
                    [616, -134],
                    [677, -85],
                ],
                waypointRadius: 10,
                waypointFill: "yellow",
                waypointStroke: {color: 'red', width: '1px'},
                routeStroke: {color: 'red', width: '1px', 'dasharray': '5,10'},
            };




            var oakwoods_to_pinewoods = {
                waypoints: [
                    [-455, -193],
                    [-465, -174],
                ],
                route: [
                    [-455, -193],
                    [-457, -185],
                    [-465, -174],
                ],
                waypointRadius: 5,
                waypointFill: "yellow",
                waypointStroke: {color: 'red', width: '1px'},
                routeStroke: {color: 'red', width: '1px', 'dasharray': '2,3'},
            };

            var box_lake_cliffs = {
                world_coords: [
                    [645, 451],
                    [635, 454],
                    [634, 468],
                    [629, 472],
                    [633, 488],
                    [654, 491],
                ],
                fill: "none",
                stroke: {color: 'gray', width: '1px'},
            };

            var box_lake_route = {
                waypoints: [
                    [655, 482],
                    [654, 485],
                ],
                route: [
                    [655, 482],
                    [654, 485],
                ],
                waypointRadius: 5,
                waypointFill: "yellow",
                waypointStroke: {color: 'red', width: '1px'},
                routeStroke: {color: 'red', width: '1px', 'dasharray': '2,3'},
            };

            var sw_canyon_edge1 = {
                world_coords: [
                    [380, 578],
                    [367, 590],
                    [329, 600],
                    [302, 586],
                    [298, 566],
                    [288, 552],
                    [279, 548],
                    [265, 563],
                    [257, 570],
                    [228, 570],
                    [213, 558],
                ],
                fill: "none",
                stroke: {color: 'gray', width: '1px'}
            };

            var sw_canyon_edge2 = {
                world_coords: [
                    [214, 547],
                    [238, 559],
                    [248, 561],
                    [255, 555],
                    [260, 543],
                    [267, 538],
                    [282, 536],
                    [294, 547],
                    [313, 561],
                    [324, 585],
                    [335, 588],
                    [358, 583],
                    [372, 572],
                    [389, 562],
                ],
                fill: "none",
                stroke: {color: 'gray', width: '1px'}
            };

            var forest_sw_edge1 = {
                world_coords: [
                    [232, 524],
                    [276, 509],
                    [320, 519],
                    [342, 503],
                    [349, 498],
                    [356, 503],
                    [359, 508],
                    [351, 520],
                    [359, 534],
                    [379, 541],
                    [391, 520],
                    [402, 501],
                    [396, 480],
                    [409, 463],
                    [418, 478],
                    [413, 488],
                    [414, 500],
                    [434, 512],
                    [435, 532],
                    [450, 537],
                    [460, 527],
                    [477, 527],
                    [483, 531],
                    [481, 517],
                    [487, 505],
                    [461, 497],
                        [471, 484],
                        [465, 474],
                        [481, 466],
                        [475, 443],
                        [486, 455],
                        [496, 460],
                        [489, 486],
                        [494, 496],
                        [509, 498],
                        [507, 492],
                        [527, 491],
                        [545, 447],
                        [557, 435],
                        [555, 406],
                        [573, 393],
                        [554, 382],
                        [531, 389],
                        [525, 376],
                        [536, 369],
                        [511, 331],
                        [516, 313],
                        [510, 292],
                        [500, 295],
                        [487, 281],
                        [487, 267],
                        [495, 260],
                        [500, 271],
                        [509, 267],
                        [507, 234],
                        [497, 229],
                        [487, 215],
                        [503, 207],
                        [508, 213],
                        [520, 209],
                        [529, 202],
    [537, 198],
    [539, 193],
    [529, 182],
    [518, 181],
    [507, 175],
    [508, 170],
    [520, 151],
    [530, 144],
    [538, 131],
    [539, 119],
    [514, 100],
    [524, 94],
    [532, 104],
    [560, 114],
    [565, 94],
    [579, 105],
    [602, 88],
    [597, 56],
    [594, 31],
    [606, 3],
    [623, -13],
    [637, -27],
    [629, -36],
    [631, -41],
    [650, -38],
    [667, -43],
        [685, -27],
        [700, -39],
        [696, -54],
        [679, -65],
        [673, -82],
        [681, -86],
        [696, -76],
        [707, -87],
        [701, -98],
        [690, -109],
        [695, -115],
        [633, -188],
        [653, -198],
        [678, -201],
        [708, -190],
        [707, -209],
        [668, -204],
        [654, -210],



                ],
                fill: "none",
                stroke: {color: 'green', width: '1px'},
            }

            var sw_bridge = {
                world_coords: [
                    [288, 552],
                    [294, 547],
                ], 
                fill: "none",
                stroke: {color: 'orange', width: '2px'},
            };

            var shelter_lake = {
                title: "Shelter Lake",
                world_coords: [
                    [468, 543],
                    [469, 546],
                    [467, 548],
                    [457, 549],
                    [455, 547],
                    [457, 544],
                    [462, 542],
                    [467, 541],
                    [468, 543],
                ],
                fill: "skyblue",
                stroke: {color: 'darkblue', width: '1px'}
            };

            var blue_lake = {
                title: "Blue Lake",
                world_coords: [
                    [576, 447],
                    [575, 451],
                    [580, 451],
                    [580, 448],
                    [579, 446],
                    [576, 447],
                ],
                fill: "skyblue",
                stroke: {color: 'darkblue', width: '1px'}
            };

            var random_forest_edges = [
                [-313, -48],
                [-695, 269],
                [-337, -212],
                [581, 431],
                [366, -579],
                [538, 569],
                [614, 448],
                [479, -26],
            ];

            var taco_forest_edges = {
                world_coords: [
                    [115, -749],
                    [108, -747],
                    [102, -694],
                    [149, -680],
                    [170, -699],
                    [202, -671],
                    [216, -656],
                    [253, -668],
                    [295, -654],
                    [323, -660],
                    [352, -652],
                    [389, -656],
                    [426, -623],
                    [444, -621],
                    [457, -648],
                    [464, -616],
                    [484, -623],
                    [490, -643],
                    [518, -664],
                    [542, -559],
                    [547, -544],
                    [578, -537],
                    [590, -520],
                    [608, -514],
                    [616, -493],
                    [610, -461],
                    [618, -422],
                    [634, -401],
                    [650, -394],
                    [670, -370],
                    [669, -359],
                    [660, -361],
                    [653, -335],
                    [671, -298],
                    [660, -285],
                    [647, -272],
                    [636, -288],
                    [620, -299],
                    [615, -285],
                    [633, -268],
                    [654, -236],
                    [654, -210],

                ],
                fill: "none",
                stroke: {color: 'green', width: '1px'}
            };

            var dryo_grove1 = {
                world_coords: [
                    [-451, -278],
                    [-464, -266],
                    [-469, -275],
                    [-457, -302],
                    [-447, -302],
                    [-451, -278],

                ],
                fill: "none",
                stroke: {color: 'green', width: '1px'}
            }

            var cliff_4 = {
                world_coords: [
                    [-403, -128],
                    [-380, -105],
                    [-358, -90],
                    [-321, -57],
                    [-313, -48],
                    [-298, -9],
                ],
                fill: "none",
                stroke: {color: 'gray', width: '1px'}

            }

            var spino_road = {
                world_coords: [
                    [731, -196],
                    [728, -170],
                    [744, -127],
                    [752, -103],
                    [745, -74],
                    [746, -50],
                    [750, -18],
                    [728, 15],
                    [683, 49],
                    [681, 64],
                ],
                fill: "none",
                stroke: {color: 'orange', width: '1px'}
            };

            var taco_road = {
                world_coords: [
                    [732, -202],
                    [734, -261],
                    [726, -281],
                    [718, -301],
                    [724, -328],
                    [735, -336],
                    [731, -379],
                    [713, -435],
                    [729, -466],
                    [708, -512],
                    [696, -519],
                [697, -538],
                    [710, -557],
                    [710, -616],
                ],
                fill: "none",
                stroke: {color: 'orange', width: '1px'}
            };

            var taco_road2 = {
                world_coords: [
                    [713, -435],
                    [693, -446],
                    [675, -453],
                    [662, -475],
                    [643, -489],
                    [627, -491],
                    [616, -493],
                    [592, -517],
                    [576, -540],
                    [577, -566],
                    [566, -590],
                    [575, -601],
                    [572, -622],
                    [587, -637],
                    [588, -644],
                    [579, -656],
                    [592, -669],
                ],
                fill: "none",
                stroke: {color: 'orange', width: '1px'}
            };

            var taco_road3 = {
                world_coords: [
                    [696, -638],
                    [672, -636],
                    [661, -642],
                    [644, -644],
                    [628, -661],
                    [592, -669],
                    [586, -684],
                    [575, -695],
                    [540, -714],
                    [502, -718],
                    [472, -713],
                    [442, -716],
                ],
                fill: "none",
                stroke: {color: 'orange', width: '1px'}
            };

            var galli_road1 = {
                world_coords: [
                    [624, 483],
                    [639, 503],
                    [643, 522],
                    [654, 543],
                    [654, 554],
                    [618, 552],
                    [605, 561],
                    [608, 591],
                    [595, 606],
                    [569, 644],
                    [550, 651],
                ],
                fill: "none",
                stroke: {color: 'orange', width: '1px'}
            };


            var random_road_pts = [
                    [654, 554],
                    [605, 561],
                [713, -435],
                [417, 560],
                [276, 509],
                [270, 518],
                [231, 531], // crossroads
                [201, 529],
                [516, 174],
                [409, 463],
                [418, 478],
                [487, 505],
                [473, 561],
                [483, 539],
                [427, 552],
                [-464, -563],
                [550, 552],
                [-478, -578],
                [669, -566],
                [632, -536],
                [618, -509],
                [356, 503],
                [409, 463],
                [418, 478],
                //[591, -669], // crossroads
                //[643, -645],
                [672, -634], // crossroads
                [700, -610],
                [578, -571],
                [578, -537],
                [590, -520],
                [616, -493],



            ];




        </script>
        <script type='text/javascript'>
            var WIDTH = 1600;

            function world2raw(x, y) {
                if(Array.isArray(x)) {
                    y = x[1];
                    x = x[0];
                }
                return [WIDTH/2 - y, WIDTH/2 + x];
            }

            function raw2world(x, y) {
                if(Array.isArray(x)) {
                    y = x[1];
                    x = x[0];
                }
                return [-WIDTH/2 + y, WIDTH/2 - x];
            }


            function start() {
                if(SVG.supported) {
                    document.getElementById('badness').style.display = "none";
                }
                var svg = SVG('canvas1').size(WIDTH, WIDTH)
                var rect = svg.rect(WIDTH, WIDTH).fill('#9db9f9');

                drawPath(svg, coast);
                drawPath(svg, crater);
                drawPath(svg, redwood_outline);
                drawPath(svg, oakwoods_outline);
                drawPath(svg, redwood_canyon_outline);
                drawPath(svg, redwood_canyon2_outline);
                drawPath(svg, boiling_lake_outline);
                drawPath(svg, some_other_lake);
                drawPath(svg, cypress_outline);
                drawPath(svg, some_swampy);
                drawPath(svg, scrubby_lake);
                drawPath(svg, scrubby_lake2);
                drawPath(svg, pit_lake);
                drawPath(svg, rocky_lake);
                drawPath(svg, cypress_lake);
                drawPath(svg, redwood_lake);
                drawPath(svg, redwood_cliff3);
                drawPath(svg, swamp_lake2);
                drawPath(svg, big_lake);
                drawPath(svg, iits_lake_outline);
                drawPath(svg, iits_cliff);
                drawPath(svg, another_cliff);
                drawPath(svg, implied_canyontop);
                drawPath(svg, implied_canyontop2);
                drawPath(svg, sw_canyon_edge1);
                drawPath(svg, sw_canyon_edge2);
                drawPath(svg, sw_bridge);
                drawPath(svg, iits_cliff2);
                drawPath(svg, cactus_lake);
                drawPath(svg, box_lake_cliffs);
                drawPath(svg, forest_sw_edge1);
                drawPath(svg, taco_forest_edges);
                drawPath(svg, dryo_grove1);
                drawPath(svg, cliff_4);
                drawPath(svg, spino_road);
                drawPath(svg, taco_road);
                drawPath(svg, taco_road2);
                drawPath(svg, taco_road3);
                drawPath(svg, galli_road1);
                drawRoute(svg, box_lake_route);
                drawRoute(svg, canyon_entrance1_route2);
                drawRoute(svg, canyon_entrance1_route);
                drawRoute(svg, box_canyon_route1);
                drawRoute(svg, box_canyon3);
                drawRoute(svg, redwood_cliff_passage);
                drawRoute(svg, redwood_route1);
                drawRoute(svg, redwood_route2);
                drawRoute(svg, redwood_route3);
                drawPath(svg, box_lake);
                drawPath(svg, shelter_lake);
                drawPath(svg, blue_lake);
                drawRoute(svg, iits_route1);
                drawRoute(svg, cactus_to_canyon);
                drawRoute(svg, cactus_to_canyon2);
                drawRoute(svg, redwood_entrance4_route);
                drawRoute(svg, volcano_canyon1);
                drawRoute(svg, oakwoods_to_pinewoods);
                drawRoute(svg, a_route);


                random_forest_edges.forEach(function(pt) {
                    var xy, circle;
                    xy = world2raw(pt);
                    circle = svg.circle(5).center(xy[0], xy[1]).fill('green');
                });
                random_road_pts.forEach(function(pt) {
                    var xy, circle;
                    xy = world2raw(pt);
                    circle = svg.circle(4).center(xy[0], xy[1]).fill('orange');
                });
                forage_plants.forEach(function(pt) {
                    var xy, circle;
                    xy = world2raw(pt);
                    circle = svg.circle(10).center(xy[0], xy[1]).fill('lightgreen').stroke({color: 'darkgreen'});
                });
                blue_plants.forEach(function(pt) {
                    var xy, circle;
                    xy = world2raw(pt);
                    circle = svg.circle(10).center(xy[0], xy[1]).fill('lightblue').stroke({color: 'darkgreen'});
                });

                drawCompass(svg);

                /*

                xy = world2raw(0, 100);
                circle = svg.circle(10).center(xy[0], xy[1]).fill('red');

                xy = world2raw(0, 0);
                circle = svg.circle(10).center(xy[0], xy[1]).fill('#000');
                */

                var canvas = document.getElementById("canvas1");

                canvas.addEventListener('mousemove', onMouseMove);
            }

            function drawRoute(svg, route) {
                var routeCoords = route.route.map(world2raw);
                svg.polyline(routeCoords).stroke(route.routeStroke).fill('none');
                route.waypoints.forEach(function(waypoint) { 
                    var cpt = world2raw(waypoint);
                    var group = svg.group();
                    group.element('title').words("" + waypoint[0] + " " + waypoint[1]);
                    var circle = svg.circle(route.waypointRadius).center(cpt[0], cpt[1]).fill(route.waypointFill).stroke(route.waypointStroke);
                    group.put(circle);

                });
            }

            function drawPath(svg, obj) {
                var coords = obj.world_coords.map(world2raw);
                var group = svg.group();
                if(obj.title != null) {
                    group.element('title').words(obj.title);
                }

                var path = svg.polyline(coords).fill(obj.fill).stroke(obj.stroke);
                group.put(path);

            }

            function drawCircle(svg, obj) {
                var cpt = world2raw(obj.center);
                var group = svg.group();
                if('title' in obj && obj.title != null) {
                    group.element("title").words(obj.title);
                }
                var circle = svg.circle(obj.radius).center(cpt[0], cpt[1]).fill(obj.fill).stroke(obj.stroke);
                group.put(circle);
                //var title = svg.element('title').words('hi');
                //title.addTo(circle);
            }

            function drawCompass(svg) {
                var stroke1 = {color: '#000', width: '1px'};
                var radius = 160;
                var rect = svg.rect(radius, radius)
                    .fill('white')
                    .move(WIDTH-10-radius, 10)
                    .stroke(stroke1);
                var makeArrow = function() {
                    return svg.polyline([[0, 5],[5, 5],[2, 20], [0, 5]]).fill('none').stroke(stroke1);   
                }
                var cx = WIDTH-10-radius/2;
                var cy = 10 + radius/2;
                for(var i = 0; i < 360; i+=90) {
                    var arrow = makeArrow();
                    arrow.move(cx-2, cy+10).rotate(i, cx, cy);
                }
                circle = svg.circle(10).center(cx, cy).fill('red');

                var text = svg.plain("-X");
                text.center(cx, cy - 45);
                var text = svg.plain("dir: -180");
                text.center(cx, cy - 65);

                var text = svg.plain("+X");
                text.center(cx, cy + 45);
                var text = svg.plain("dir: 0");
                text.center(cx, cy + 65);
                
                var text = svg.plain("+Y");
                text.center(cx - 50, cy - 10);
                var text = svg.plain("dir: 90");
                text.center(cx - 50, cy + 10);

                var text = svg.plain("-Y");
                text.center(cx + 50, cy - 10);
                var text = svg.plain("dir: -90");
                text.center(cx + 50, cy + 10);

            }

            function pad(x) {
                var s = x + "";
                var n = s.length;
                for(var i = n; i<5; i++) {
                    s = "&nbsp;" + s;
                }
                return s;
            }

            function onMouseMove(_event) {
                var canvas = document.getElementById('canvas1');
                var origin = getOffsetTopLeft(canvas);
                var raw_x = _event.layerX - Math.floor(origin.left);
                var raw_y = _event.layerY - Math.floor(origin.top);
                var world_xy = raw2world(raw_x, raw_y);
                document.getElementById('xyreporter').innerHTML = "" + pad(world_xy[0]) + " " + pad(world_xy[1]);
            }

            function getOffsetTopLeft(elt) {
                // see http://javascript.info/tutorial/coordinates
                var box = elt.getBoundingClientRect()
                return { top: box.top + window.pageYOffset, left: box.left + window.pageXOffset};
            }
        </script>
	</head>
    <body onload='start()'>
        <pre id='badness'>No SVG for you!
        -- your browser
        </pre>
        <div id='xyreporter' class='coord-display'>
        </div>
        <div id='canvas1'>
        </div>
    </body>
</html>

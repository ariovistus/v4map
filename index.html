
<html>
	<head>
        <script src='./svg.js' type='text/javascript'></script>
        <script type='text/javascript'>
            //// data!

            var crater = {
                title: "Volcanic Crater",
                world_coords: [
                    [-24, -70],
                    [-49, -45],
                    [-20, 0], // fake!!!
                    [0, 50], // fake!!!
                    [150, 0], // fake!!!
                    [131, -75],
                    [58, -54],
                    [45, -56],
                    [-24, -70]
                ],
                fill: "gray",
                stroke: {color: 'brown', width: '1px'}
            };

            var blue_plants = [
                [-51, -516],
                [680, 90],
                [164, 582],
            ];

            var redwood_lake = {
                title: "Redwood Lake",
                center: [-318, 271],
                radius: 20,
                fill: "skyblue",
                stroke: {color: 'darkblue', width: '1px'}
            };

            var swamp_lake = {
                title: "Swamp Lake",
                center: [-440, -50],
                radius: 25,
                fill: "skyblue",
                stroke: {color: 'darkblue', width: '1px'}
            };

            var box_lake = {
                title: "Box Lake",
                center: [135, -415],
                radius: 25,
                fill: "skyblue",
                stroke: {color: 'darkblue', width: '1px'}
            };

            var cactus_lake = {
                title: "Cactus Lake",
                center: [-50, -515],
                radius: 25,
                fill: "skyblue",
                stroke: {color: 'darkblue', width: '1px'}
            };

            var iits_lake = {
                title: "Island in the Sky Lake",
                center: [440, -260],
                radius: 25,
                fill: "skyblue",
                stroke: {color: 'darkblue', width: '1px'}
            };

            var iits_lake_outline = {
                title: "Island in the Sky Lake",
                world_coords: [
                    [451, -261],
                    [451, -249],
                    [444, -249],
                    [444, -260],
                    [450, -267],
                    [451, -261],
                ],
                fill: "skyblue",
                stroke: {color: 'darkblue', width: '1px'}
            };



            var redwood_outline = {
                world_coords: [
                    [126, -276],
                    [128, -345],
                    [130, -412], 
                    [135, -415], 
                ],
                fill: "none",
                stroke: {color: 'darkgreen', width: '1px'}
            };

            var redwood_canyon_outline = {
                world_coords: [
                    [135, -415], 
                    [123, -424], 
                    [119, -442], 
                    [122, -448], 
                    [119, -454], 
                    [105, -456], 
                    [94, -462], 
                    [83, -461], 
                    [64, -445], 
                    [68, -437], 
                    [73, -438], 
                ],
                fill: "none",
                stroke: {color: 'gray', width: '1px'}
            };

            var redwood_canyon2_outline = {
                world_coords: [
                    [392, -156],
                    [381, -157],
                    [374, -166],
                    [318, -174],
                    [337, -190],
                    [357, -217],
                    [341, -250],
                    [338, -284],
                    [330, -296],
                    [342, -314],
                    [310, -327],
                    [305, -327],
                    [300, -332],
                    [293, -333],
                    [292, -336],
                    [295, -339],
                    [299, -338],
                    [300, -332],
                    [305, -327],
                    [312, -338],
                    [304, -344],
                    [303, -354],
                    [342, -354],
                    [358, -330],
                    [365, -326],
                    [379, -313],
                    [402, -313],
                    [422, -308],
                    [435, -307],
                    [444, -314],
                    [445, -325],
                    [467, -337],
                ],
                fill: "none",
                stroke: {color: 'gray', width: '1px'}
            };

            var oakwoods_outline = {
                world_coords: [
                    [-403, -83], 
                    [-424, -110], 
                    [-453, -146],
                    [-477, -176],
                    [-469, -181],
                    [-479, -190],
                    [-508, -185],
                    [-545, -199],
                    [-588, -201],
                    [-604, -187],
                    [-594, -185],
                    [-575, -140],
                    [-551, -115],
                    [-512, -106],
                    [-499, -127],
                ],
                fill: "none",
                stroke: {color: 'darkgreen', width: '1px'}
            };

            var boiling_lake_outline = {
                title: "Boiling Lake",
                world_coords: [
                    [160, 554],
                    [168, 562],
                    [168, 565],
                    [165, 575],
                    [159, 584],
                    [154, 584],
                    [154, 577],
                    [159, 573],
                    [157, 568],
                    [156, 563],
                    [160, 554],
                ],
                fill: "skyblue",
                stroke: {color: 'darkblue', width: '1px'}
            };

            var canyon_entrance1 = {
                title: "A canyon entrance",
                center: [-589, -132],
                radius: 15,
                fill: "yellow",
                stroke: {color: 'red', width: '2px'}
            };

            var box_canyon_route1 = {
                waypoints: [
                    [-48, -207],
                    [-108, -335],
                ],
                route: [
                    [-48, -207],
                    [-108, -335],
                    [-5, -429],
                    [54, -445],
                    [135, -415],
                ],
                waypointRadius: 10,
                waypointFill: "yellow",
                waypointStroke: {color: 'red', width: '1px'},
                routeStroke: {color: 'red', width: '1px', 'dasharray': '5,10'},
            };

            var iits_route1 = {
                waypoints: [
                    [450, 0],
                ],
                route: [
                    [450, 0],
                ],
                waypointRadius: 10,
                waypointFill: "yellow",
                waypointStroke: {color: 'red', width: '1px'},
                routeStroke: {color: 'red', width: '1px', 'dasharray': '5,10'},
            };

            var cactus_to_canyon = {
                waypoints: [
                    [-34, -472],
                    [-5, -429],
                ],
                route: [
                    [-34, -472],
                    [-42, -464],
                    [-5, -429],
                ],
                waypointRadius: 10,
                waypointFill: "yellow",
                waypointStroke: {color: 'red', width: '1px'},
                routeStroke: {color: 'red', width: '1px', 'dasharray': '5,10'},
            };

        </script>
        <script type='text/javascript'>
            var WIDTH = 1500;

            function world2raw(x, y) {
                if(Array.isArray(x)) {
                    y = x[1];
                    x = x[0];
                }
                return [WIDTH/2 - y, WIDTH/2 + x];
            }


            function start() {
                if(SVG.supported) {
                    document.getElementById('badness').style.display = "none";
                }
                var svg = SVG('canvas1').size(WIDTH, WIDTH)
                var rect = svg.rect(WIDTH, WIDTH).attr({ fill: '#fff' });
                var rect = svg.rect(WIDTH, WIDTH).fill('none').stroke({color: '#000', width: '2px'});
                //var circle = svg.circle(100).center(500, 500).fill('#000');


                drawCompass(svg);
                drawPath(svg, crater);
                drawPath(svg, redwood_outline);
                drawPath(svg, oakwoods_outline);
                drawPath(svg, redwood_canyon_outline);
                drawPath(svg, redwood_canyon2_outline);
                drawPath(svg, boiling_lake_outline);
                drawCircle(svg, redwood_lake);
                drawCircle(svg, swamp_lake);
                drawCircle(svg, box_lake);
                //drawCircle(svg, iits_lake);
                drawPath(svg, iits_lake_outline);
                drawCircle(svg, cactus_lake);
                drawCircle(svg, canyon_entrance1);
                drawRoute(svg, box_canyon_route1);
                drawRoute(svg, iits_route1);
                drawRoute(svg, cactus_to_canyon);


                var xy, circle;
                xy = world2raw(100, 0);
                circle = svg.circle(10).center(xy[0], xy[1]).fill('red');

                xy = world2raw(0, 100);
                circle = svg.circle(10).center(xy[0], xy[1]).fill('red');

                xy = world2raw(0, 0);
                circle = svg.circle(10).center(xy[0], xy[1]).fill('#000');
            }

            function drawRoute(svg, route) {
                var routeCoords = route.route.map(world2raw);
                svg.polyline(routeCoords).stroke(route.routeStroke).fill('none');
                route.waypoints.forEach(function(waypoint) { 
                    console.info("waypoint: ", waypoint);
                    var cpt = world2raw(waypoint);
                    var group = svg.group();
                    group.element('title').words("" + waypoint[0] + " " + waypoint[1]);
                    var circle = svg.circle(route.waypointRadius).center(cpt[0], cpt[1]).fill(route.waypointFill).stroke(route.waypointStroke);
                    group.put(circle);

                });
            }

            function drawPath(svg, obj) {
                var coords = obj.world_coords.map(world2raw);
                var group = svg.group();
                if(obj.title != null) {
                    group.element('title').words(obj.title);
                }

                var path = svg.polyline(coords).fill(obj.fill).stroke(obj.stroke);
                group.put(path);

            }

            function drawCircle(svg, obj) {
                var cpt = world2raw(obj.center);
                var group = svg.group();
                if('title' in obj && obj.title != null) {
                    group.element("title").words(obj.title);
                }
                var circle = svg.circle(obj.radius).center(cpt[0], cpt[1]).fill(obj.fill).stroke(obj.stroke);
                group.put(circle);
                //var title = svg.element('title').words('hi');
                //title.addTo(circle);
            }

            function drawCompass(svg) {
                var stroke1 = {color: '#000', width: '1px'};
                var radius = 160;
                var rect = svg.rect(radius, radius)
                    .fill('none')
                    .move(WIDTH-10-radius, 10)
                    .stroke(stroke1);
                var makeArrow = function() {
                    return svg.polyline([[0, 5],[5, 5],[2, 20], [0, 5]]).fill('none').stroke(stroke1);   
                }
                var cx = WIDTH-10-radius/2;
                var cy = 10 + radius/2;
                for(var i = 0; i < 360; i+=90) {
                    var arrow = makeArrow();
                    arrow.move(cx-2, cy+10).rotate(i, cx, cy);
                }
                circle = svg.circle(10).center(cx, cy).fill('red');

                var text = svg.plain("-X");
                text.center(cx, cy - 45);
                var text = svg.plain("dir: -180");
                text.center(cx, cy - 65);

                var text = svg.plain("+X");
                text.center(cx, cy + 45);
                var text = svg.plain("dir: 0");
                text.center(cx, cy + 65);
                
                var text = svg.plain("+Y");
                text.center(cx - 50, cy - 10);
                var text = svg.plain("dir: 90");
                text.center(cx - 50, cy + 10);

                var text = svg.plain("-Y");
                text.center(cx + 50, cy - 10);
                var text = svg.plain("dir: -90");
                text.center(cx + 50, cy + 10);

            }
        </script>
	</head>
    <body onload='start()'>
        <pre id='badness'>No SVG for you!
        -- your browser
        </pre>
        <div id='canvas1' width='1000' height='1000'>
        </div>
    </body>
</html>
